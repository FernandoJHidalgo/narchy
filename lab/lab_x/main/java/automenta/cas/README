Adapted from:
https://github.com/langdon-holly/langdonMath-java